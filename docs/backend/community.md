# 커뮤니티 기능 (Community Features)

## 1. 투표 시스템 (`src/topics`)

사용자가 토픽에 대한 자신의 입장을 표현할 수 있게 합니다.

### 데이터 모델 (`tn_topic_vote`)

- `topic_id`: 투표 대상 토픽입니다.
- `user_id`: 투표한 사용자입니다.
- `side`: `LEFT` 또는 `RIGHT`.

### 로직

- 사용자당 토픽별로 한 번의 투표만 가능합니다.
- 토픽이 `VOTING` 상태인 동안에는 투표를 변경할 수 있습니다.
- 통계(백분율)는 실시간으로 계산됩니다.

## 2. 댓글 (`src/comments`)

사용자는 특정 토픽에 대해 토론할 수 있습니다.

### 데이터 모델 (`tn_comment`)

- `topic_id`: 댓글의 맥락이 되는 토픽입니다.
- `user_id`: 작성자입니다.
- `content`: 텍스트 내용입니다.
- `parent_id`: 대댓글(스레드)을 위한 상위 댓글 ID입니다.

### 기능

- **스레딩**: 답글 체인을 지원합니다.
- **중재**: 관리자는 부적절한 댓글을 숨기거나 삭제할 수 있습니다.
- **반응**: 사용자는 댓글에 좋아요/싫어요를 표시할 수 있습니다 (구현된 경우).

## 3. 실시간 채팅 (`src/chat`)

각 토픽에 대해 라이브 채팅방을 제공합니다.

### 아키텍처

- **프로토콜**: `socket.io`를 통한 WebSocket.
- **게이트웨이**: `ChatGateway`가 연결, 방 참여, 메시지 브로드캐스팅을 처리합니다.

### 흐름 (Flow)

1.  **연결**: 클라이언트가 JWT로 연결합니다.
2.  **방 참여**: 클라이언트가 `topicId`와 함께 `joinRoom` 이벤트를 보냅니다.
3.  **메시지**: 클라이언트가 `sendMessage`를 보냅니다. 서버는 `tn_chat`에 저장하고 방에 브로드캐스트합니다.
4.  **라이브 업데이트**: 서버는 방에 있는 모든 클라이언트에게 `newMessage` 이벤트를 보냅니다.

### 데이터 모델 (`tn_chat`)

- `topic_id`: 채팅방 식별자입니다.
- `user_id`: 보낸 사람입니다.
- `content`: 메시지 텍스트입니다.
- `status`: `ACTIVE`, `HIDDEN` (신고된 메시지용).
